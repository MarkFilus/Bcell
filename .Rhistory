input=list()
input$gene="CD19"
plotRS(input)
source("help.R")
plotRS(input)
library(ggplot2)
plotRS(input)
library(gridExtra)
plotRS(input)
dim(data)
load("BcellShiny.RData")
ls()
dim(data)
plotRS(input)
paste0
?paste0
install.packages("pathview",repos="http://R-Forge.R-project.org")
install.packages("KEGGgraph")
install.packages("png")
install.packages("KEGGREST")
source("http://bioconductor.org/biocLite.R")
biocLite("KEGGgraph")
source("http://bioconductor.org/biocLite.R")
biocLite("KEGGREST")
install.packages("pathview",repos="http://R-Forge.R-project.org")
library(pathView)
library(pathview)
data(gse16873.d)
dim(gse16873.d)
rownames(gse16873.d)
?cpd2kegg
?pathview::id2eg
gene.idtype.list[1]
id2eg(rownames(data), "SYMBOL")
data(demo.paths)
?pathview
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[i],
+ species = "hsa", out.suffix = "gse16873", kegg.native = T)
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[i], species = "hsa", out.suffix = "gse16873", kegg.native = T)
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "gse16873", kegg.native = T)
dim(gene.data)
gse16873.d[,1]
?pathview
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "gse16873", kegg.native = F)
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[i], species = "hsa", out.suffix = "gse16873", kegg.native = T, same.layer=F)
pv.out <- pathview(gene.data = gse16873.d[, 1], pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "gse16873", kegg.native = T, same.layer=F)
demo.paths()
demo.paths
demo.paths$sel.paths
pv.out <- pathview(gene.data = scale(subset[,1, drop=F]), pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "gse16873", gene.idtype = "symbol", kegg.native = T, same.layer=F)
data(gene.idtype.list)
gene.idtype.list
pv.out <- pathview(gene.data = scale(subset[,1, drop=F]), pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "gse16873", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F)
library("~/UsefulRfuncs.R")
source("~/UsefulRfuncs.R")
subsetm=meanByF(subset, subset.f)
subsetm=tscale(subsetm)
pv.out <- pathview(gene.data = scale(subsetm[,1, drop=F]), pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F)
subsetm["MCM2",]
pv.out <- pathview(gene.data = scale(subsetm[,c(1,2,4), drop=F]), pathway.id = demo.paths$sel.paths[1], species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = scale(subsetm[,c(1,2,4), drop=F]), pathway.id = "00010", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
colnames(subsetm)
pv.out <- pathview(gene.data = scale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00010", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
subsetm=meanByF(subset, subset.f)
pv.out <- pathview(gene.data = tscale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00010", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
mscale=function(data){sweep(data,1,apply(data,1,mean), "-")}
pv.out <- pathview(gene.data = mscale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00010", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00020", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00562", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(subsetm[,c(1,4,2), drop=F]), pathway.id = "00071", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
load("GCdata.RData")
pwd()
getwd()
load("BcellShiny.RData")
load("BcellShiny.RData")
load("GCdata.RData")
ls()
plotGC=function(input){
if (! is.na(match(input$gene, rownames(dataGC)))){
theme_set(theme_bw())
df=list()
df$y=dataGC[input$gene,]
df$x=1:length(df$y)
df$col=dataGC.f
df=as.data.frame(df)
p<-ggplot(df, aes(x=col,
y=y,
color=col,
ymin=mean(y),
ymax=mean(y)))+
geom_pointrange(size=2)+ylab("log2 Intensity")+
ggtitle("SubsetArray")+theme(text = element_text(size=20))
print(p)
}
else{
grid.text(label=paste("Gene:", input$gene, "is not in dataset"))
}
}
input$gene
input$gene="SLC22A5"
plotGC(input)
library(ggplot2)
library(gridExtra)
plotGC(input)
hist(dataGC)
dataGC=log2(dataGC)
plotGC(input)
hist(dataGC)
hist(dataGC)
plotGC(input)
geneSet=intersect(rownames(dataGC), rownames(subset), rownames(data))
geneSet=union(rownames(dataGC), rownames(subset), rownames(data))
geneSet=union(c(rownames(dataGC), rownames(subset), rownames(data)))
geneSet=union(rownames(dataGC), geneSet)
save(geneSet, dataGC, dataGC.f, subset, subset.f, data, pop, facts, file="BcellShiny.RData")
max(dataGC)
load("BcellShiny.RData")
max(dataGC)
plotGC(input)
GCm=meanByF(dataGC, dataGC.f)
colnames(GCm)
pv.out <- pathview(gene.data = mscale(GCm, drop=F]), pathway.id = "00071", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(GCm), pathway.id = "00071", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
library(pathview)
mscale=function(data){sweep(data,1,apply(data,1,mean), "-")}
pv.out <- pathview(gene.data = mscale(GCm), pathway.id = "00071", species = "hsa", out.suffix = "subsetData", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(GCm), pathway.id = "00071", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
conames(GCm)
colnames(GCm)
pv.out <- pathview(gene.data = mscale(GCm), pathway.id = "00190", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
pv.out <- pathview(gene.data = mscale(GCm), pathway.id = "00010", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=T)
?pathview
GCmi=read.table("GCdiff.human")
pv.out <- pathview(gene.data = GCmi[,1], pathway.id = "00010", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
??pathview
library(pathview)
pv.out <- pathview(gene.data = GCmi[,1], pathway.id = "00010", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
GCmi[,1]
GCmi[,2]
GCmi=read.table("GCdiff.human", row.names=1)
pv.out <- pathview(gene.data = GCmi[,1], pathway.id = "00010", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
GCm
rownames(GCm)
rownames(GCmi)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00071", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00071", species = "hsa", out.suffix = "GCdata", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00071", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = F, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00071", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = F, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = F, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "01100", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00046", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00546", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00049", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000049", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00050", species = "hsa", out.suffix = "GCdataGV", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "tmp", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "01200", species = "hsa", out.suffix = "tmp", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00230", species = "hsa", out.suffix = "tmp", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00230", species = "hsa", out.suffix = "tmp", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F, expand.node = T, low = -4, hi=4)
?pathview
GCmi["ENTPD1",]
GCmi["ENTPD5",]
GCmi=read.table("GCdiff.human", row.names=1)
max(abs(GCmi[,1]))
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00230", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
load("GCmiSeq.RData")
shiny::runApp()
?scale_color_brewer
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
library("RColorBrewer")
display.brewer.all()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
pv.out <- pathview(gene.data = -GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
library(pathview)
GCmi=-GCmi
GCmi=read.table("GCdiff.human", row.names=1)
GCmi=-GCmi
max(abs(GCmi))
GCmi=GCmi/max(abs(GCmi))
pv.out <- pathview(gene.data = -GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
GCmi=read.table("GCdiff.human", row.names=1)
GCmi=-GCmi
pv.out <- pathview(gene.data = -GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00230", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
GCmi=read.table("GCdiff.human", row.names=1)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00010", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00270", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00230", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00306", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "03060", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00190", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00020", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00250", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00030", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "01212", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "001212", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "012120", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00086", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000086", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000860", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000082", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00082", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000820", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "000082", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00061", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00071", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
shiny::runApp()
pv.out <- pathview(gene.data = GCmi[,1, drop=F], pathway.id = "00590", species = "hsa", out.suffix = "GCmiSeq", gene.idtype = "SYMBOL", kegg.native = T, same.layer=F, multi.state=F)
